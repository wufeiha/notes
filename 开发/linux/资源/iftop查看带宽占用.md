**1、安装**

> CentOS系统运行：yum install iftop
> Debian系统 运行：apt-get install iftop

**2、安装好后在服务器执行iftop -i eth1就可以查看服务器公网网卡带宽使用情况(如果只执行iftop默认检测第一块网卡使用情况，这样查的会是内网网卡eth0。**

```shell
[root@iZ23kick03xZ ~]# iftop -i eth0 -P
```
注：-P 参数会将请求服务的端口显示出来，也就是说是通过服务器哪个端口建立的连接，看内网流量执行 iftop -i eth0 -P 命令。

![img](https://i.loli.net/2020/11/05/F3dsMQzO6Efk1xP.png)

![1.jpg](https://i.loli.net/2020/11/05/Ufo1a46gNRMj8V7.jpg)

**3、界面字段含义**

> 1. 第一行：带宽显示
> 2. 中间部分：外部连接列表，即记录了哪些ip正在和本机的网络连接
> 3. 中间部分右边：实时参数分别是该访问ip连接到本机2秒，10秒和40秒的平均流量=>代表发送数据，<= 代表接收数据
> 4. 底部三行：表示发送，接收和全部的流量
> 5. 底部三行第二列：为你运行iftop到目前流量
> 6. 底部三行第三列：为高峰值
> 7. 底部三行第四列：为平均值
> 8. 通过iftop的界面很容易找到哪个ip在占用网络流量，这个是ifstat做不到的。不过iftop的流量显示单位是Mb,这个b是bit，是位，不是字节，而ifstat的KB，这个B就是字节了，byte是bit的8倍。

**4、界面操作**

> 1. 进入iftop画面后的一些操作命令(注意大小写)
> 2. 按h切换是否显示帮助;
> 3. 按n切换显示本机的IP或主机名;
> 4. 按s切换是否显示本机的host信息;
> 5. 按d切换是否显示远端目标主机的host信息;
> 6. 按t切换显示格式为2行/1行/只显示发送流量/只显示接收流量;
> 7. 按N切换显示端口号或端口服务名称;
> 8. 按S切换是否显示本机的端口信息;
> 9. 按D切换是否显示远端目标主机的端口信息;
> 10. 按p切换是否显示端口信息;
> 11. 按P切换暂停/继续显示;
> 12. 按b切换是否显示平均流量图形条;
> 13. 按B切换计算2秒或10秒或40秒内的平均流量;
> 14. 按T切换是否显示每个连接的总流量;
> 15. 按l打开屏幕过滤功能，输入要过滤的字符，比如ip,按回车后，屏幕就只显示这个IP相关的流量信息;
> 16. 按L切换显示画面上边的刻度;刻度不同，流量图形条会有变化;
> 17. 按j或按k可以向上或向下滚动屏幕显示的连接记录;
> 18. 按1或2或3可以根据右侧显示的三列流量数据进行排序;
> 19. 按<根据左边的本机名或IP排序;
> 20. 按>根据远端目标主机的主机名或IP排序;
> 21. 按o切换是否固定只显示当前的连接;
> 22. 按f可以编辑过滤代码；
> 23. 按!可以使用shell命令；
> 24. 按q退出监控。

有时候我们的网络缓慢并不是由远程服务器或路由器所引起,而只是因为系统中的某些进程占用了太多可用带宽。虽然从直观角度我们很难确定哪些进程正在使用带宽,但也有一些工具能帮大家把这些捣蛋的家伙揪出来。与大多数 Linux 命令相似, iftop 也拥有多种高级选项。我们在文章中提到的这些已经足以涵盖大多数故障排查需求,但为了满足大家进一步了解 iftop 功能的愿望,我教各位一个小技巧:只要输入 man iftop ,就可以阅读包含在软件包当中的使用手册、获得更多与之相关的知识。